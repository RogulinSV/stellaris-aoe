namespace = aoe_pulse_actions

event = {
    id = aoe_pulse_actions.1
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        every_playable_country = {
            random_owned_planet = {
                limit = {
                    has_modifier = "planet_interstellar_research"
                }
                save_event_target_as = "observatory_owner_planet"
                prev = {
                    save_event_target_as = "observatory_owner_country"
                }
                if = {
                    limit = {
                        has_building = "building_observatory_1"
                    }
                    planet_event = {
                        id = aoe_pulse_actions.4
                        days = 60
                        random = 30
                    }
                    random = {
                        chance = 75
                        planet_event = {
                            id = aoe_pulse_actions.4
                            days = 120
                            random = 60
                        }
                    }
                    random = {
                        chance = 50
                        planet_event = {
                            id = aoe_pulse_actions.4
                            days = 180
                            random = 90
                        }
                    }
                    random = {
                        chance = 25
                        planet_event = {
                            id = aoe_pulse_actions.4
                            days = 240
                            random = 120
                        }
                    }
                    while = {
                        count = 1
                        closest_system = {
                            min_steps = 1
                            max_steps = 8
                            limit = {
                                any_system_planet = {
                                    OR = {
                                        habitable_planet = yes
                                        is_outerworlds_planet = yes
                                        is_extraterrestrial_planet = yes
                                    }
                                    NOT = {
                                        is_same_value = prevprev
                                    }
                                    OR = {
                                        has_owner = no
                                        owner = {
                                            is_same_value = prevprevprev
                                        }
                                    }
                                    check_variable = {
                                        which = "observed_resources_planet_counter"
                                        value < 5
                                    }
                                }
                            }
                            random_system_planet = {
                                limit = {
                                    OR = {
                                        habitable_planet = yes
                                        is_outerworlds_planet = yes
                                        is_extraterrestrial_planet = yes
                                    }
                                    NOT = {
                                        is_same_value = prevprev
                                    }
                                    OR = {
                                        has_owner = no
                                        owner = {
                                            is_same_value = prevprevprev
                                        }
                                    }
                                }
                                if = {
                                    limit = {
                                        check_variable = {
                                            which = "observed_resources_planet_counter"
                                            value < 1
                                        }
                                    }
                                    set_variable = {
                                        which = "observed_resources_planet_counter"
                                        value = 1
                                    }
                                }
                                else = {
                                    change_variable = {
                                        which = "observed_resources_planet_counter"
                                        value = 1
                                    }
                                }
                                planet_event = {
                                    id = aoe_pulse_actions.2
                                    days = 720
                                    random = 360
                                }
                                log = "aoe_pulse_actions.1: planet [This.GetName] was selected to add deposit"
                            }
                        }
                    }
                }
                else_if = {
                    limit = {
                        has_building = "building_observatory_2"
                    }
                    planet_event = {
                        id = aoe_pulse_actions.4
                        days = 60
                        random = 30
                    }
                    planet_event = {
                        id = aoe_pulse_actions.4
                        days = 120
                        random = 60
                    }
                    planet_event = {
                        id = aoe_pulse_actions.4
                        days = 180
                        random = 90
                    }
                    random = {
                        chance = 80
                        planet_event = {
                            id = aoe_pulse_actions.4
                            days = 240
                            random = 120
                        }
                    }
                    random = {
                        chance = 60
                        planet_event = {
                            id = aoe_pulse_actions.4
                            days = 300
                            random = 150
                        }
                    }
                    random = {
                        chance = 40
                        planet_event = {
                            id = aoe_pulse_actions.4
                            days = 360
                            random = 180
                        }
                    }
                    random = {
                        chance = 20
                        planet_event = {
                            id = aoe_pulse_actions.4
                            days = 420
                            random = 210
                        }
                    }
                    while = {
                        count = 2
                        closest_system = {
                            min_steps = 0
                            max_steps = 16
                            limit = {
                                any_system_planet = {
                                    OR = {
                                        habitable_planet = yes
                                        is_outerworlds_planet = yes
                                        is_extraterrestrial_planet = yes
                                    }
                                    NOT = {
                                        is_same_value = prevprev
                                    }
                                    OR = {
                                        has_owner = no
                                        owner = {
                                            is_same_value = prevprevprev
                                        }
                                    }
                                    check_variable = {
                                        which = "observed_resources_planet_counter"
                                        value < 10
                                    }
                                }
                            }
                            random_system_planet = {
                                limit = {
                                    OR = {
                                        habitable_planet = yes
                                        is_outerworlds_planet = yes
                                        is_extraterrestrial_planet = yes
                                    }
                                    NOT = {
                                        is_same_value = prevprev
                                    }
                                    OR = {
                                        has_owner = no
                                        owner = {
                                            is_same_value = prevprevprev
                                        }
                                    }
                                }
                                if = {
                                    limit = {
                                        check_variable = {
                                            which = "observed_resources_planet_counter"
                                            value < 1
                                        }
                                    }
                                    set_variable = {
                                        which = "observed_resources_planet_counter"
                                        value = 1
                                    }
                                }
                                else = {
                                    change_variable = {
                                        which = "observed_resources_planet_counter"
                                        value = 1
                                    }
                                }
                                planet_event = {
                                    id = aoe_pulse_actions.2
                                    days = 360
                                    random = 180
                                }
                                log = "aoe_pulse_actions.1: planet [This.GetName] was selected to add deposits"
                            }
                        }
                    }
                }
            }
        }
    }
}

planet_event = {
    id = aoe_pulse_actions.2
    hide_window = yes
    is_triggered_only = yes

    immediate = {
        if = {
            limit = {
                NOT = {
                    has_industrial_deposits = yes
                }
            }
            if = {
                limit = {
                    OR = {
                        habitable_planet = yes
                        is_outerworlds_planet = yes
                    }
                }
                random_list = {
                    5 = {
                        add_deposit = "d_sr_mithril_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_orihalk_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_adamantium_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_vibranium_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_itildeen_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_thiotimoline_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_unobtanium_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_stalgrim_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_terrigen_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_kryptonite_deposit"
                    }
                    8 = {
                        add_deposit = "d_crystallized_caves"
                    }
                    8 = {
                        add_deposit = "d_crystallized_plains"
                    }
                    8 = {
                        add_deposit = "d_crystallized_mines"
                    }
                    8 = {
                        add_deposit = "d_crystallized_stratums"
                    }
                    8 = {
                        add_deposit = "d_crystallized_hills"
                    }
                    8 = {
                        add_deposit = "d_crystallized_matrixes"
                    }
                }
            }
            else_if = {
                limit = {
                    is_extraterrestrial_planet = yes
                }
                random_list = {
                    5 = {
                        add_deposit = "d_sr_mithril_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_orihalk_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_adamantium_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_vibranium_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_itildeen_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_thiotimoline_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_unobtanium_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_stalgrim_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_terrigen_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_kryptonite_deposit"
                    }
                    16 = {
                        add_deposit = "d_extraterrestrial_monomorphic_deposits"
                    }
                    16 = {
                        add_deposit = "d_extraterrestrial_polymorphic_deposits"
                    }
                    16 = {
                        add_deposit = "d_extraterrestrial_isomorphic_deposits"
                    }
                }
            }
        }
        else_if = {
            limit = {
                NOT = {
                    has_manufacturing_deposits = yes
                }
            }
            if = {
                limit = {
                    OR = {
                        habitable_planet = yes
                        is_outerworlds_planet = yes
                    }
                }
                random_list = {
                    5 = {
                        add_deposit = "d_sr_yuranic_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_cobaltium_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_satramene_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_lirium_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_nevarrit_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_tiberium_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_chalcolivan_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_corenite_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_engos_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_helium_deposit"
                    }
                    8 = {
                        add_deposit = "d_metallized_caves"
                    }
                    8 = {
                        add_deposit = "d_metallized_plains"
                    }
                    8 = {
                        add_deposit = "d_metallized_mines"
                    }
                    8 = {
                        add_deposit = "d_metallized_mountains"
                    }
                    8 = {
                        add_deposit = "d_metallized_oceans"
                    }
                    8 = {
                        add_deposit = "d_metallized_matrixes"
                    }
                }
            }
            else_if = {
                limit = {
                    is_extraterrestrial_planet = yes
                }
                random_list = {
                    5 = {
                        add_deposit = "d_sr_yuranic_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_cobaltium_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_satramene_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_lirium_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_nevarrit_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_tiberium_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_chalcolivan_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_corenite_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_engos_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_helium_deposit"
                    }
                    16 = {
                        add_deposit = "d_extraterrestrial_monomeric_deposits"
                    }
                    16 = {
                        add_deposit = "d_extraterrestrial_polymeric_deposits"
                    }
                    16 = {
                        add_deposit = "d_extraterrestrial_isomeric_deposits"
                    }
                }
            }
        }
        else_if = {
            limit = {
                NOT = {
                    has_scientific_deposits = yes
                }
            }
            if = {
                limit = {
                    OR = {
                        habitable_planet = yes
                        is_outerworlds_planet = yes
                    }
                }
                random_list = {
                    5 = {
                        add_deposit = "d_sr_elerium_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_gravitoid_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_tylium_deposit"
                    }
                    5 = {
                        add_deposit = "d_sr_energon_deposit"
                    }
                    10 = {
                        if = {
                            limit = {
                                is_dry = yes
                            }
                            add_deposit = "d_spice_lakes"
                        }
                        else_if = {
                            limit = {
                                is_wet = yes
                            }
                            add_deposit = "d_floating_gardens"
                        }
                        else_if = {
                            limit = {
                                is_cold = yes
                            }
                            add_deposit = "d_relic_ice"
                        }
                        else = {
                            add_deposit = "d_ancient_pillars"
                        }
                    }
                    10 = {
                        if = {
                            limit = {
                                is_dry = yes
                            }
                            add_deposit = "d_plasmatic_cobblestones"
                        }
                        else_if = {
                            limit = {
                                is_wet = yes
                            }
                            add_deposit = "d_floating_islands"
                        }
                        else_if = {
                            limit = {
                                is_cold = yes
                            }
                            add_deposit = "d_soil_funnels"
                        }
                        else = {
                            add_deposit = "d_ancient_pillars"
                        }
                    }
                }
            }
            else_if = {
                limit = {
                    is_extraterrestrial_planet = yes
                }
                random_list = {
                    5 = {
                        add_deposit = "d_extraterrestrial_vagrant_biome"
                    }
                    5 = {
                        add_deposit = "d_extraterrestrial_foggy_biome"
                    }
                    5 = {
                        add_deposit = "d_extraterrestrial_pungent_biome"
                    }
                    5 = {
                        add_deposit = "d_extraterrestrial_tremendous_biome"
                    }
                }
            }
        }
        else = {
            random_list = {
                30 = {
                    if = {
                        limit = {
                            has_orihalk_resource = yes
                        }
                        add_deposit = "d_sr_mithril_deposit"
                    }
                    else_if = {
                        limit = {
                            has_orihalk_resource = yes
                        }
                        add_deposit = "d_sr_orihalk_deposit"
                    }
                    else_if = {
                        limit = {
                            has_yuranic_resource = yes
                        }
                        add_deposit = "d_sr_yuranic_deposit"
                    }
                    else_if = {
                        limit = {
                            has_adamantium_resource = yes
                        }
                        add_deposit = "d_sr_adamantium_deposit"
                    }
                    else_if = {
                        limit = {
                            has_vibranium_resource = yes
                        }
                        add_deposit = "d_sr_vibranium_deposit"
                    }
                    else_if = {
                        limit = {
                            has_cobaltium_resource = yes
                        }
                        add_deposit = "d_sr_cobaltium_deposit"
                    }
                    else_if = {
                        limit = {
                            has_itildeen_resource = yes
                        }
                        add_deposit = "d_sr_itildeen_deposit"
                    }
                    else_if = {
                        limit = {
                            has_satramene_resource = yes
                        }
                        add_deposit = "d_sr_satramene_deposit"
                    }
                    else_if = {
                        limit = {
                            has_lirium_resource = yes
                        }
                        add_deposit = "d_sr_lirium_deposit"
                    }
                    else_if = {
                        limit = {
                            has_nevarrit_resource = yes
                        }
                        add_deposit = "d_sr_nevarrit_deposit"
                    }
                    else_if = {
                        limit = {
                            has_thiotimoline_resource = yes
                        }
                        add_deposit = "d_sr_thiotimoline_deposit"
                    }
                    else_if = {
                        limit = {
                            has_unobtanium_resource = yes
                        }
                        add_deposit = "d_sr_unobtanium_deposit"
                    }
                    else_if = {
                        limit = {
                            has_stalgrim_resource = yes
                        }
                        add_deposit = "d_sr_stalgrim_deposit"
                    }
                    else_if = {
                        limit = {
                            has_tiberium_resource = yes
                        }
                        add_deposit = "d_sr_tiberium_deposit"
                    }
                    else_if = {
                        limit = {
                            has_elerium_resource = yes
                        }
                        add_deposit = "d_sr_elerium_deposit"
                    }
                    else_if = {
                        limit = {
                            has_gravitoid_resource = yes
                        }
                        add_deposit = "d_sr_gravitoid_deposit"
                    }
                    else_if = {
                        limit = {
                            has_tylium_resource = yes
                        }
                        add_deposit = "d_sr_tylium_deposit"
                    }
                    else_if = {
                        limit = {
                            has_chalcolivan_resource = yes
                        }
                        add_deposit = "d_sr_chalcolivan_deposit"
                    }
                    else_if = {
                        limit = {
                            has_terrigen_resource = yes
                        }
                        add_deposit = "d_sr_terrigen_deposit"
                    }
                    else_if = {
                        limit = {
                            has_corenite_resource = yes
                        }
                        add_deposit = "d_sr_corenite_deposit"
                    }
                    else_if = {
                        limit = {
                            has_energon_resource = yes
                        }
                        add_deposit = "d_sr_energon_deposit"
                    }
                    else_if = {
                        limit = {
                            has_engos_resource = yes
                        }
                        add_deposit = "d_sr_engos_deposit"
                    }
                    else_if = {
                        limit = {
                            has_helium_resource = yes
                        }
                        add_deposit = "d_sr_helium_deposit"
                    }
                    else_if = {
                        limit = {
                            has_kryptonite_resource = yes
                        }
                        add_deposit = "d_sr_kryptonite_deposit"
                    }
                    else = {
                        random_list = {
                            3 = {
                                add_deposit = "d_sr_mithril_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_orihalk_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_adamantium_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_vibranium_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_itildeen_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_thiotimoline_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_unobtanium_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_stalgrim_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_terrigen_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_kryptonite_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_yuranic_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_cobaltium_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_satramene_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_lirium_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_nevarrit_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_tiberium_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_chalcolivan_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_corenite_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_engos_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_helium_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_elerium_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_gravitoid_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_tylium_deposit"
                            }
                            3 = {
                                add_deposit = "d_sr_energon_deposit"
                            }
                            4 = {
                                add_deposit = "d_crystallized_caves"
                            }
                            4 = {
                                add_deposit = "d_crystallized_plains"
                            }
                            4 = {
                                add_deposit = "d_crystallized_mines"
                            }
                            4 = {
                                add_deposit = "d_crystallized_stratums"
                            }
                            4 = {
                                add_deposit = "d_crystallized_hills"
                            }
                            4 = {
                                add_deposit = "d_metallized_caves"
                            }
                            4 = {
                                add_deposit = "d_metallized_plains"
                            }
                            4 = {
                                add_deposit = "d_metallized_mines"
                            }
                            4 = {
                                add_deposit = "d_metallized_mountains"
                            }
                            4 = {
                                add_deposit = "d_metallized_oceans"
                            }
                            4 = {
                                if = {
                                    limit = {
                                        is_dry = yes
                                        OR = {
                                            habitable_planet = yes
                                            is_outerworlds_planet = yes
                                        }
                                    }
                                    add_deposit = "d_spice_lakes"
                                }
                                else_if = {
                                    limit = {
                                        is_wet = yes
                                        OR = {
                                            habitable_planet = yes
                                            is_outerworlds_planet = yes
                                        }
                                    }
                                    add_deposit = "d_floating_gardens"
                                }
                                else_if = {
                                    limit = {
                                        is_cold = yes
                                        OR = {
                                            habitable_planet = yes
                                            is_outerworlds_planet = yes
                                        }
                                    }
                                    add_deposit = "d_relic_ice"
                                }
                                else = {
                                    add_deposit = "d_ancient_pillars"
                                }
                            }
                            4 = {
                                if = {
                                    limit = {
                                        is_dry = yes
                                    }
                                    add_deposit = "d_plasmatic_cobblestones"
                                }
                                else_if = {
                                    limit = {
                                        is_wet = yes
                                    }
                                    add_deposit = "d_floating_islands"
                                }
                                else_if = {
                                    limit = {
                                        is_cold = yes
                                    }
                                    add_deposit = "d_soil_funnels"
                                }
                                else = {
                                    add_deposit = "d_ancient_pillars"
                                }
                            }
                        }
                    }
                }
                30 = {
                    if = {
                        limit = {
                            is_dry = yes
                            OR = {
                                habitable_planet = yes
                                is_outerworlds_planet = yes
                            }
                        }
                        random_list = {
                            2 = {
                                add_deposit = "d_arid_highlands"
                            }
                            2 = {
                                add_deposit = "d_searing_desert"
                            }
                            2 = {
                                add_deposit = "d_geothermal_vent"
                            }
                            2 = {
                                add_deposit = "d_tempestous_mountain"
                            }
                            2 = {
                                add_deposit = "d_veiny_cliffs"
                            }
                            2 = {
                                add_deposit = "d_mineral_fields"
                            }
                            2 = {
                                add_deposit = "d_prosperous_mesa"
                            }
                            2 = {
                                add_deposit = "d_rich_mountain"
                            }
                            2 = {
                                add_deposit = "d_bountiful_plains"
                            }
                            2 = {
                                add_deposit = "d_nutritious_mudland"
                            }
                            2 = {
                                add_deposit = "d_fertile_lands"
                            }
                            2 = {
                                add_deposit = "d_great_river"
                            }
                        }
                    }
                    else_if = {
                        limit = {
                            is_wet = yes
                        }
                        if = {
                            limit = {
                                habitable_planet = yes
                            }
                            random_list = {
                                2 = {
                                    add_deposit = "d_blooming_fields"
                                }
                                2 = {
                                    add_deposit = "d_wildness_fields"
                                }
                                2 = {
                                    add_deposit = "d_underwater_oasis"
                                }
                                2 = {
                                    add_deposit = "d_shrouded_mountains"
                                }
                                2 = {
                                    add_deposit = "d_cascade_oasis"
                                }
                                2 = {
                                    add_deposit = "d_hot_springs"
                                }
                                2 = {
                                    add_deposit = "d_rushing_waterfalls"
                                }
                                2 = {
                                    add_deposit = "d_underwater_vent"
                                }
                                2 = {
                                    add_deposit = "d_tempestous_mountain"
                                }
                                2 = {
                                    add_deposit = "d_veiny_cliffs"
                                }
                                2 = {
                                    add_deposit = "d_mineral_fields"
                                }
                                2 = {
                                    add_deposit = "d_prosperous_mesa"
                                }
                                2 = {
                                    add_deposit = "d_submerged_ore_veins"
                                }
                                2 = {
                                    add_deposit = "d_rugged_woods"
                                }
                                2 = {
                                    add_deposit = "d_green_hills"
                                }
                                2 = {
                                    add_deposit = "d_lush_jungle"
                                }
                                2 = {
                                    add_deposit = "d_fertile_lands"
                                }
                                2 = {
                                    add_deposit = "d_black_soil"
                                }
                            }
                        }
                        else_if = {
                            limit = {
                                is_outerworlds_planet = yes
                            }
                            random_list = {
                                2 = {
                                    add_deposit = "d_blooming_fields"
                                }
                                2 = {
                                    add_deposit = "d_wildness_fields"
                                }
                                2 = {
                                    add_deposit = "d_underwater_oasis"
                                }
                                2 = {
                                    add_deposit = "d_shrouded_mountains"
                                }
                                2 = {
                                    add_deposit = "d_cascade_oasis"
                                }
                            }
                        }
                    }
                    else_if = {
                        limit = {
                            is_cold = yes
                            OR = {
                                habitable_planet = yes
                                is_outerworlds_planet = yes
                            }
                        }
                        random_list = {
                            2 = {
                                add_deposit = "d_hot_springs"
                            }
                            2 = {
                                add_deposit = "d_frozen_gas_lake"
                            }
                            2 = {
                                add_deposit = "d_geothermal_vent"
                            }
                            2 = {
                                add_deposit = "d_veiny_cliffs"
                            }
                            2 = {
                                add_deposit = "d_ore_rich_caverns"
                            }
                            2 = {
                                add_deposit = "d_rich_mountain"
                            }
                            2 = {
                                add_deposit = "d_lichen_fields"
                            }
                            2 = {
                                add_deposit = "d_forgiving_tundra"
                            }
                            2 = {
                                add_deposit = "d_fungal_caves"
                            }
                        }
                    }
                    else_if = {
                        limit = {
                            is_extraterrestrial_planet = yes
                        }
                        random_list = {
                            2 = {
                                add_deposit = "d_extraterrestrial_windy_highlands"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_gaseus_emissions"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_boiling_springs"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_rushing_maelstroms"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_geothermal_reservoirs"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_radioactive_deposits"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_electric_thunderhead"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_scorched_desert"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_igneous_mountains"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_mineral_caves"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_mineral_fields"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_mineral_glaciers"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_mineral_veins"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_mineral_highlands"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_mineral_reservoirs"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_prosperous_mesa"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_rich_mineral_mountains"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_rich_mineral_veins"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_organic_plantations"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_isothermal_oasis"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_underground_crops"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_frozen_floodplains"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_organic_woods"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_tectonic_lakes"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_cave_greenhouses"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_loached_jungles"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_hydroponic_pillars"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_organic_plains"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_organic_caverns"
                            }
                            2 = {
                                add_deposit = "d_extraterrestrial_isolated_biomes"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_crystal_caves"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_crystal_plains"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_crystal_desert"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_crystal_reef"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_crystal_mountains"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_crystal_mines"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_dust_caves"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_dust_geysers"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_dust_desert"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_dust_clouds"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_dust_streams"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_dust_stratums"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_rotten_marsh"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_porous_valleys"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_frozen_lakes"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_porous_vesicle"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_gaseous_reservoirs"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_gaseous_oceans"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_betharian_pillars"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_betharian_quarries"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_protozoa_fauna"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_relict_fauna"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_monomorphic_deposits"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_polymorphic_deposits"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_isomorphic_deposits"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_monomeric_deposits"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_polymeric_deposits"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_isomeric_deposits"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_vagrant_biome"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_foggy_biome"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_pungent_biome"
                            }
                            1 = {
                                add_deposit = "d_extraterrestrial_tremendous_biome"
                            }
                        }
                    }
                }
                40 = {}
            }
        }

        if = {
            limit = {
                exists = event_target:observatory_owner_country
            }
            save_event_target_as = "observatory_target_planet"
            event_target:observatory_owner_country = {
                country_event = {
                    id = aoe_pulse_actions.3
                }
            }
        }

        log = "aoe_pulse_actions.2: Deposits added into the planet «[This.GetName]» from «[This.solar_system.GetName]» system"
    }
}

country_event = {
    id = aoe_pulse_actions.3
    title = aoe_pulse_actions.3.title
    desc = aoe_pulse_actions.3.desc
    picture = GFX_aoe_planet_deposits_discovered
    show_sound = event_finding_loot
    is_triggered_only = yes
    location = event_target:observatory_target_planet

    immediate = {
        log = "aoe_pulse_actions.3: Deposits added into the planet «[event_target:observatory_target_planet.GetName]» from «[event_target:observatory_target_planet.solar_system.GetName]» system"
    }

    option = {
        name = aoe_pulse_actions.3.a
        custom_tooltip = aoe_pulse_actions.3.a.tooltip
    }
}

planet_event = {
    id = aoe_pulse_actions.4
    is_triggered_only = yes
    hide_window = yes

    trigger = {
        exists = event_target:observatory_owner_country
        exists = owner
        owner = {
            is_same_value = event_target:observatory_owner_country
        }
        OR = {
            has_building = "building_observatory_1"
            has_building = "building_observatory_2"
        }
    }

    immediate = {
        if = {
            limit = {
                has_building = "building_observatory_2"
            }
            solar_system = {
                closest_system = {
                    min_steps = 1
                    max_steps = 20
                    limit = {
                        any_system_planet = {
                            is_surveyed = {
                                who = event_target:observatory_owner_country
                                status = no
                            }
                        }
                    }
                    every_system_planet = {
                        limit = {
                            is_surveyed = {
                                who = event_target:observatory_owner_country
                                status = no
                            }
                        }
                        surveyed = {
                            set_surveyed = yes
                            surveyor = event_target:observatory_owner_country
                        }
                    }
                }
            }
        }
        else = {
            solar_system = {
                closest_system = {
                    min_steps = 1
                    max_steps = 10
                    limit = {
                        any_system_planet = {
                            is_surveyed = {
                                who = event_target:observatory_owner_country
                                status = no
                            }
                        }
                    }
                    every_system_planet = {
                        limit = {
                            is_surveyed = {
                                who = event_target:observatory_owner_country
                                status = no
                            }
                        }
                        surveyed = {
                            set_surveyed = yes
                            surveyor = event_target:observatory_owner_country
                        }
                    }
                }
            }
        }
    }
}